
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A tutorial demonstrating workflow and project management in NOMAD
">
      
      
        <meta name="author" content="FAIRmat consortium">
      
      
        <link rel="canonical" href="https://fairmat-nfdi.github.io/nomad-tutorial-workflows/api/">
      
      
        <link rel="prev" href="../core/">
      
      
        <link rel="next" href="../custom/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Part 2 - Python API - NOMAD Tutorial Workflows</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Titillium Web";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-2-using-nomads-api-for-project-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NOMAD Tutorial Workflows" class="md-header__button md-logo" aria-label="NOMAD Tutorial Workflows" data-md-component="logo">
      
  <img src="../assets/nomad-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NOMAD Tutorial Workflows
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part 2 - Python API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/FAIRmat-NFDI/nomad-tutorial-workflows" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NOMAD Tutorial Workflows" class="md-nav__button md-logo" aria-label="NOMAD Tutorial Workflows" data-md-component="logo">
      
  <img src="../assets/nomad-logo.png" alt="logo">

    </a>
    NOMAD Tutorial Workflows
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FAIRmat-NFDI/nomad-tutorial-workflows" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 1 - Core Functionalities
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Part 2 - Python API
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Part 2 - Python API
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-you-will-learn" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What You Will Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programmatic-uploads" class="md-nav__link">
    <span class="md-ellipsis">
      🛠️ Programmatic Uploads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-files-and-data" class="md-nav__link">
    <span class="md-ellipsis">
      Set up / files and data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-the-nomad-utility-workflows-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Install the nomad-utility-workflows plugin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linking-to-your-nomad-account" class="md-nav__link">
    <span class="md-ellipsis">
      Linking to your NOMAD account
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomad-urls-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      NOMAD URLs / Deployments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-api-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading API Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uploading API Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-the-upload-status" class="md-nav__link">
    <span class="md-ellipsis">
      Checking the upload status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-your-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Deleting your upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-the-project-data" class="md-nav__link">
    <span class="md-ellipsis">
      Working with the project Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with the project Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iterative-uploading-with-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Iterative Uploading with Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-individual-entries-of-an-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing individual entries of an upload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#editing-the-upload-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Editing the upload metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-uploads" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing Uploads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-resources" class="md-nav__link">
    <span class="md-ellipsis">
      More Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 3 - Custom Entries
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Part 4 - Custom Workflows
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-you-will-learn" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 What You Will Learn
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programmatic-uploads" class="md-nav__link">
    <span class="md-ellipsis">
      🛠️ Programmatic Uploads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-files-and-data" class="md-nav__link">
    <span class="md-ellipsis">
      Set up / files and data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-the-nomad-utility-workflows-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      Install the nomad-utility-workflows plugin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linking-to-your-nomad-account" class="md-nav__link">
    <span class="md-ellipsis">
      Linking to your NOMAD account
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomad-urls-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      NOMAD URLs / Deployments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uploading-api-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading API Basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uploading API Basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-the-upload-status" class="md-nav__link">
    <span class="md-ellipsis">
      Checking the upload status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-your-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Deleting your upload
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-the-project-data" class="md-nav__link">
    <span class="md-ellipsis">
      Working with the project Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with the project Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iterative-uploading-with-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Iterative Uploading with Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-individual-entries-of-an-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing individual entries of an upload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Datasets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#editing-the-upload-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Editing the upload metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-uploads" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing Uploads
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-resources" class="md-nav__link">
    <span class="md-ellipsis">
      More Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="part-2-using-nomads-api-for-project-management">Part 2: Using NOMAD’s API for Project Management<a class="headerlink" href="#part-2-using-nomads-api-for-project-management" title="Permanent link">&para;</a></h1>
<h2 id="what-you-will-learn">🎯 What You Will Learn<a class="headerlink" href="#what-you-will-learn" title="Permanent link">&para;</a></h2>
<ul>
<li>How to interface with NOMAD using a simplified Python API</li>
<li>How to (programmatically) upload data, edit metadata, create datasets, and publish data</li>
</ul>
<hr />
<h2 id="programmatic-uploads">🛠️ Programmatic Uploads<a class="headerlink" href="#programmatic-uploads" title="Permanent link">&para;</a></h2>
<p><strong>Challenge:</strong>
You need to upload the DFT calculations to NOMAD, but this large set of calculations were performed and are currently stored on your groups HPC cluster. (Here we will only work with 3 calculations for demonstration purposes).</p>
<p><strong>Your Solution:</strong>
Use the <strong><a href="https://fairmat-nfdi.github.io/nomad-utility-workflows/" target="_blank"><code>nomad-utility-workflows</code></a></strong> module!</p>
<div class="admonition warning">
<p class="admonition-title">Attention</p>
<p>The exercises below are intended to be performed in a single jupyter session (pre-filled example notebooks provided below).</p>
</div>
<h2 id="set-up-files-and-data">Set up / files and data<a class="headerlink" href="#set-up-files-and-data" title="Permanent link">&para;</a></h2>
<p>On the HPC cluster we have collected our data within the following directory structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>root
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── DFT-1
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│   └── 0iCl0nWwCftF0tgQOaklcQLFB68E.zip
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│       ├── aims.out # FHIAims mainfile
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│       └── ...other raw simulation files
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>├── DFT-2
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│   └── 24Q4MoaAUtsWN7Hepw3UH3TU93pX.zip
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│       ├── aims.out # FHIAims mainfile
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│       └── ...other raw simulation files
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>└── DFT-3
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    └── 6V_q8X39he-dakYHifH_3Z53GTdZ.zip
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        ├── aims.out # FHIAims mainfile
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        └── ...other raw simulation files
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This data was actually obtained from querying NOMAD for DFT calculations of water, with a certain number of atoms within the simulations. The zip files are named according to the corresponding <code>entry_id</code>'s of this data. Instead of supplying the test data directly here, later in this part of the tutorial, we will instead use the API functionalities to reconstruct the above structure by downloading the data directly from NOMAD.</p>
</div>
<h2 id="install-the-nomad-utility-workflows-plugin">Install the nomad-utility-workflows plugin<a class="headerlink" href="#install-the-nomad-utility-workflows-plugin" title="Permanent link">&para;</a></h2>
<p>If you have not done so already, follow the installation instructions <a href="../#tutorial-preparation">Tutorial Preparation</a>.</p>
<h2 id="linking-to-your-nomad-account">Linking to your NOMAD account<a class="headerlink" href="#linking-to-your-nomad-account" title="Permanent link">&para;</a></h2>
<p>If you have not done so already, create a NOMAD account at <a href="https://nomad-lab.eu/prod/v1/gui/about/information" target="_blank">NOMAD Central Deployment</a>. Click <code>LOGIN/REGISTER</code> at the top right.</p>
<p>Store your credentials in a file called <code>.env</code> in the root working directory for this tutorial with the following content:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">NOMAD_USERNAME</span><span class="o">=</span><span class="s2">&quot;MyLogin&quot;</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nv">NOMAD_PASSWORD</span><span class="o">=</span><span class="s2">&quot;MyPassWord&quot;</span>
</code></pre></div>
and insert your username and password.</p>
<div class="admonition warning">
<p class="admonition-title">Attention</p>
<p>The environment file <strong>MUST</strong> be called exactly ".env" to be read in correctly with our approach.</p>
</div>
<p>The <code>.env</code> file you placed in the root folder will be loaded within each jupyter notebook with the command <code>load_dotenv()</code> found in next steps.
The functions within the utility module will automatically retrieve an authentication token for privileged operations, e.g., uploading data to your account.</p>
<details class="tip">
<summary>Tip - If your <code>.env</code> file is not found</summary>
<p>If the authentication credentials from your <code>.env</code> file is not picked, add this directory to your <code>PYTHONPATH</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="nv">$PYTHONPATH</span>:&lt;path-to-tutorial-root-working-directory&gt;
</code></pre></div></p>
</details>
<h2 id="nomad-urls-deployments">NOMAD URLs / Deployments<a class="headerlink" href="#nomad-urls-deployments" title="Permanent link">&para;</a></h2>
<p>The central NOMAD services offer several different deployments with varying purposes and versioning:</p>
<ul>
<li>"prod": The official NOMAD deployment.<ul>
<li>Updated most infrequently (as advertised in <a href="https://discordapp.com/channels/1201445470485106719/1275764272122826752">#software-updates</a> on the NOMAD Discord Server&mdash;If you are not yet a member of the NOMAD server use <a href="https://discord.gg/Gyzx3ukUw8">Invitation to Discord <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg></span></a>)</li>
</ul>
</li>
<li>"staging": The beta version of NOMAD.<ul>
<li>Updated more frequently than prod in order to integrate and test new features.</li>
</ul>
</li>
<li>"test": A test NOMAD deployment. (<strong>Used in this tutorial</strong>).<ul>
<li>The data is occassionally wiped, such that test publishing can be made.</li>
</ul>
</li>
</ul>
<p>Note that the "prod" and "staging" deployments share a common database, and that publishing on either will result in publically available data.</p>
<p>All API functions in <code>nomad-utility-workflows</code> allow the user to specify the URL with the optional keyword <code>url</code>. If you want to use the central NOMAD URLs, you can simply set <code>url</code> equal to "prod", "staging", or "test". By default, the test deployment will be used as a safety mechanism to avoid accidentally publishing during testing. Thus, for <strong>all examples in this tutorial we will be using the test deployment</strong>.</p>
<p>See <a href="https://fairmat-nfdi.github.io/nomad-utility-workflows/how_to/use_api_functions.html#nomad-urls" target="_blank">nomad-utility-workflow DOCS &gt; NOMAD URLs</a> for more information.</p>
<h2 id="uploading-api-basics">Uploading API Basics<a class="headerlink" href="#uploading-api-basics" title="Permanent link">&para;</a></h2>
<p>To demonstrate the basics of the API functionalities within <code>nomad-utility-workflows</code>, let's upload some dummy data.</p>
<p>You can create a <code>test-API.ipynb</code> notebook and copy over the following step by step, or download the prefilled notebook:</p>
<p><a class="md-button" href="../assets/test-API.ipynb" target="_blank">Download test-API.ipynb</a></p>
<p>Import the necessary modules/functions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">load_dotenv</span><span class="p">()</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">nomad_utility_workflows.utils.uploads</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">upload_files_to_nomad</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">get_upload_by_id</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">delete_upload</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_zip</span><span class="p">(</span><span class="n">zip_name</span><span class="p">,</span> <span class="n">dir_name</span><span class="p">):</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_DEFLATED</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipf</span><span class="p">:</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">dir_name</span><span class="p">):</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>                <span class="n">zipf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">dir_name</span><span class="p">))</span>
</code></pre></div>
<p>Create an empty folder and zip it:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;Test/&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">create_zip</span><span class="p">(</span><span class="s1">&#39;test.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;Test/&#39;</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">test_upload_fnm</span> <span class="o">=</span> <span class="s1">&#39;./test.zip&#39;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zip Created: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">test_upload_fnm</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Upload the zip file to the test NOMAD deployment using the <code>upload_files_to_nomad()</code> function (here we will ensure that your authentication info is set up properly):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">upload_id</span> <span class="o">=</span> <span class="n">upload_files_to_nomad</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">test_upload_fnm</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">upload_id</span><span class="p">)</span>
</code></pre></div>
<details class="success">
<summary>example output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="s1">&#39;RdA_3ZsOTMqbtAhYLivVsw&#39;</span>
</code></pre></div>
</details>
<h3 id="checking-the-upload-status">Checking the upload status<a class="headerlink" href="#checking-the-upload-status" title="Permanent link">&para;</a></h3>
<p>The returned <code>upload_id</code> can then be used to directly access the upload, e.g., to check the upload status, using <code>get_upload_by_id()</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">nomad_upload</span> <span class="o">=</span> <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">pprint</span><span class="p">(</span><span class="n">nomad_upload</span><span class="p">)</span>
</code></pre></div>
<details class="success">
<summary>example output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">NomadUpload</span><span class="p">(</span><span class="n">upload_id</span><span class="o">=</span><span class="s1">&#39;RdA_3ZsOTMqbtAhYLivVsw&#39;</span><span class="p">,</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>            <span class="n">upload_create_time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">378000</span><span class="p">),</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>            <span class="n">main_author</span><span class="o">=</span><span class="n">NomadUser</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Joseph Rudzinski&#39;</span><span class="p">),</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>            <span class="n">process_running</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>            <span class="n">current_process</span><span class="o">=</span><span class="s1">&#39;process_upload&#39;</span><span class="p">,</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>            <span class="n">process_status</span><span class="o">=</span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>            <span class="n">last_status_message</span><span class="o">=</span><span class="s1">&#39;Process process_upload completed successfully&#39;</span><span class="p">,</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>            <span class="n">errors</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>            <span class="n">warnings</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>            <span class="n">coauthors</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>            <span class="n">coauthor_groups</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>            <span class="n">reviewers</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>            <span class="n">reviewer_groups</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>            <span class="n">writers</span><span class="o">=</span><span class="p">[</span><span class="n">NomadUser</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Joseph Rudzinski&#39;</span><span class="p">)],</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>            <span class="n">writer_groups</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>            <span class="n">viewers</span><span class="o">=</span><span class="p">[</span><span class="n">NomadUser</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Joseph Rudzinski&#39;</span><span class="p">)],</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>            <span class="n">viewer_groups</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>            <span class="n">published</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>            <span class="n">published_to</span><span class="o">=</span><span class="p">[],</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>            <span class="n">with_embargo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>            <span class="n">embargo_length</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>            <span class="n">license</span><span class="o">=</span><span class="s1">&#39;CC BY 4.0&#39;</span><span class="p">,</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>            <span class="n">entries</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>            <span class="n">n_entries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>            <span class="n">upload_files_server_path</span><span class="o">=</span><span class="s1">&#39;/nomad/test/fs/staging/R/RdA_3ZsOTMqbtAhYLivVsw&#39;</span><span class="p">,</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>            <span class="n">publish_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>            <span class="n">references</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>            <span class="n">datasets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>            <span class="n">external_db</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>            <span class="n">upload_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>            <span class="n">comment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>            <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://nomad-lab.eu/prod/v1/test/api/v1&#39;</span><span class="p">,</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>            <span class="n">complete_time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">320000</span><span class="p">))</span>
</code></pre></div>
</details>
<p>One common usage of this function is to ensure that an upload has been processed successfully before making a subsequent action on it, e.g., editing the metadata or publishing. We will apply this functionality in the example below.</p>
<h3 id="deleting-your-upload">Deleting your upload<a class="headerlink" href="#deleting-your-upload" title="Permanent link">&para;</a></h3>
<p>Before moving on to the example data, let's delete this dummy upload:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">delete_upload</span><span class="p">(</span><span class="n">upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Wait a few seconds to allow for processing and then check to make sure that the upload was deleted:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Upload with upload_id=</span><span class="si">{</span><span class="n">upload_id</span><span class="si">}</span><span class="s1"> was deleted successfully.&#39;</span><span class="p">)</span>
</code></pre></div>
<details class="success">
<summary>example output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="s1">&#39;Upload with upload_id=zpq-JTzWQJ63jtSOlbueKA was deleted successfully.&#39;</span>
</code></pre></div>
</details>
<h2 id="working-with-the-project-data">Working with the project Data<a class="headerlink" href="#working-with-the-project-data" title="Permanent link">&para;</a></h2>
<p>Now that you understand some API basics, we can move to working with the data for the tutorial example project.</p>
<p>Create a new notebook <code>Part-2_DFT-calculations.ipynb</code> to work step by step or download the prefilled notebook:</p>
<p><a class="md-button" href="../assets/Part-2_DFT-calculations.ipynb" target="_blank">Download Part-2_DFT-calculations.ipynb</a></p>
<p>Make all the necessary imports:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">load_dotenv</span><span class="p">()</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">nomad_utility_workflows.utils.entries</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_entry_by_id</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">nomad_utility_workflows.utils.uploads</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="n">upload_files_to_nomad</span><span class="p">,</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="n">get_upload_by_id</span><span class="p">,</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    <span class="n">edit_upload_metadata</span><span class="p">,</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    <span class="n">publish_upload</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="p">)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">nomad_utility_workflows.utils.entries</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_entries_of_upload</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">nomad_utility_workflows.utils.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_dataset</span>
</code></pre></div>
<p>Download the example data from NOMAD and reconstruct the directory structure introduced at the beginning.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0iCl0nWwCftF0tgQOaklcQLFB68E&#39;</span><span class="p">,</span> <span class="s1">&#39;24Q4MoaAUtsWN7Hepw3UH3TU93pX&#39;</span><span class="p">,</span> <span class="s1">&#39;6V_q8X39he-dakYHifH_3Z53GTdZ&#39;</span><span class="p">]</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="k">for</span> <span class="n">i_entry</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">folder_nm</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DFT-</span><span class="si">{</span><span class="n">i_entry</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">folder_nm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">download_entry_by_id</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;prod&#39;</span><span class="p">,</span> <span class="n">zip_file_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_nm</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)))</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we have specified <code>url='prod'</code> since this data is publically available on the NOMAD production deployment. Make sure to use <code>url='test'</code> (or don't specify a url) for other function calls in this tutorial!</p>
</div>
<p>If the API call was successful you should find a zip file within each <code>DFT-X</code> folder. You can unzip these to ensure that all the raw files are present, i.e., <code>aims.out</code>, <code>aims.in</code>, etc. You can also investigate the <code>response</code> for each API call, which contains the archive (i.e., the full (meta)data stored according to NOMAD's structured schema) for each entry.</p>
<h3 id="iterative-uploading-with-checks">Iterative Uploading with Checks<a class="headerlink" href="#iterative-uploading-with-checks" title="Permanent link">&para;</a></h3>
<p>Although uploads can group multiple entries together, they are limited by the maximum upload size and act more as a practical tool for optimizing the transfer of data to the NOMAD repository. For scientifically relevant connections between entries, NOMAD uses <em>Datasets</em> and <em>Workflows</em>, which will both be covered later in the tutorial.</p>
<p>For demonstration purposes, we will upload each of the DFT calculations individually, while implementing some checks to ensure successful processing:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0iCl0nWwCftF0tgQOaklcQLFB68E&#39;</span><span class="p">,</span> <span class="s1">&#39;24Q4MoaAUtsWN7Hepw3UH3TU93pX&#39;</span><span class="p">,</span> <span class="s1">&#39;6V_q8X39he-dakYHifH_3Z53GTdZ&#39;</span><span class="p">]</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">dft_upload_ids</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># define the timing parameters</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">max_wait_time</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># 60 seconds</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 seconds</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="k">for</span> <span class="n">i_entry</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entries</span><span class="p">):</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="n">fnm</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;DFT-</span><span class="si">{</span><span class="n">i_entry</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">,</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>    <span class="c1"># make the upload</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    <span class="n">upload_id</span> <span class="o">=</span> <span class="n">upload_files_to_nomad</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">fnm</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    <span class="n">dft_upload_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upload_id</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>    <span class="c1"># wait until the upload is processed successfully before continuing</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>    <span class="k">while</span> <span class="n">elapsed_time</span> <span class="o">&lt;</span> <span class="n">max_wait_time</span><span class="p">:</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>        <span class="n">nomad_upload</span> <span class="o">=</span> <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>        <span class="c1"># Check if the upload is complete</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>        <span class="k">if</span> <span class="n">nomad_upload</span><span class="o">.</span><span class="n">process_status</span> <span class="o">==</span> <span class="s1">&#39;SUCCESS&#39;</span><span class="p">:</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>            <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nomad_upload</span><span class="p">)</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>            <span class="k">break</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>        <span class="c1"># Wait the specified interval before the next call</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>        <span class="n">elapsed_time</span> <span class="o">+=</span> <span class="n">interval</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Maximum wait time of </span><span class="si">{</span><span class="n">max_wait_time</span><span class="o">/</span><span class="mf">60.</span><span class="si">}</span><span class="s1"> minutes exceeded. Upload with id </span><span class="si">{</span><span class="n">upload_id</span><span class="si">}</span><span class="s1"> is not complete.&#39;</span><span class="p">)</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="nb">print</span><span class="p">(</span><span class="n">dft_upload_ids</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not necessary to wait between individual uploads, however, it is advisable to check that a given upload process is complete before trying to execute another process on the same upload.</p>
</div>
<h2 id="accessing-individual-entries-of-an-upload">Accessing individual entries of an upload<a class="headerlink" href="#accessing-individual-entries-of-an-upload" title="Permanent link">&para;</a></h2>
<p>We need to save both the <code>upload_id</code> and <code>entry_id</code> for each DFT upload for use later. As an alternative to copying them manually from the corresponding overview pages,
we can get them programmatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">dft_entry_ids</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">for</span> <span class="n">upload</span> <span class="ow">in</span> <span class="n">dft_upload_ids</span><span class="p">:</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">entries</span> <span class="o">=</span> <span class="n">get_entries_of_upload</span><span class="p">(</span><span class="n">upload</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">with_authentication</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">dft_entry_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">entry_id</span><span class="p">)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">dft_entry_ids</span><span class="p">)</span>
</code></pre></div>
<p>This should return a list of 3 entry ids. Copy the list into your <code>PIDs.json</code> file from Part 1:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">{</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span><span class="nt">&quot;upload_ids&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="nt">&quot;md-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;your md workflow upload id from Part 1&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="nt">&quot;DFT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">        </span><span class="s2">&quot;&lt;copy...&quot;</span><span class="p">,</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">        </span><span class="s2">&quot;the list of...&quot;</span><span class="p">,</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">        </span><span class="s2">&quot;dft upload ids&gt;&quot;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">    </span><span class="p">],</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">    </span><span class="nt">&quot;setup-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">    </span><span class="nt">&quot;analysis&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">     </span><span class="p">},</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">  </span><span class="nt">&quot;entry_ids&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span><span class="nt">&quot;md-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;your md workflow entry id from Part 1&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">    </span><span class="nt">&quot;DFT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">        </span><span class="s2">&quot;&lt;copy...&quot;</span><span class="p">,</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">        </span><span class="s2">&quot;the list of...&quot;</span><span class="p">,</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">        </span><span class="s2">&quot;dft entry ids&gt;&quot;</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">    </span><span class="p">],</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">    </span><span class="nt">&quot;setup-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="w">    </span><span class="nt">&quot;analysis&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="w">  </span><span class="nt">&quot;dataset_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="p">}</span>
</code></pre></div>
<details class="note">
<summary>Additional Exercise</summary>
<p>If you were really implementing this project managment pipeline, you would of course want to save these IDs automatically without having to copy them into a file. As an additional coding exercise, you could attempt to save the IDs into your file directly from the notebook.</p>
</details>
<h2 id="creating-datasets">Creating Datasets<a class="headerlink" href="#creating-datasets" title="Permanent link">&para;</a></h2>
<p>Let's now create a dataset to group all of our uploaded data together, substitute <code>&lt;your_name&gt;</code> before running the command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">dataset_id</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;Example Dataset - DPG Tutorial 2025 - &lt;your_name&gt;&#39;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to add your name or some unique identifier. Dataset names must be unique.</p>
</div>
<p>Copy the <code>dataset_id</code> into <code>PIDs.json</code>) for later use. (You can always find it by going to <a href="https://nomad-lab.eu/prod/v1/test/gui/user/datasets">Test Deployment &gt; PUBLISH &gt; Datasets</a> to view all of your created datasets).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p">{</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span><span class="nt">&quot;upload_ids&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="nt">&quot;md-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;your md workflow upload id from Part 1&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span><span class="nt">&quot;DFT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&lt;your list of dft upload ids from above&gt;&quot;</span><span class="p">],</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="nt">&quot;setup-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="nt">&quot;analysis&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">     </span><span class="p">},</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">  </span><span class="nt">&quot;entry_ids&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="nt">&quot;md-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;your md workflow entry id from Part 1&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="nt">&quot;DFT&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;&lt;your list of dft entry ids from above&gt;&quot;</span><span class="p">],</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">    </span><span class="nt">&quot;setup-workflow&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">    </span><span class="nt">&quot;analysis&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">  </span><span class="nt">&quot;dataset_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;copy the dataset id here&gt;&quot;</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="p">}</span>
</code></pre></div>
<h3 id="editing-the-upload-metadata">Editing the upload metadata<a class="headerlink" href="#editing-the-upload-metadata" title="Permanent link">&para;</a></h3>
<p>Now that your uploads are processed successfully, you can add coauthors, references, and other comments, as well as link to a dataset and provide a name for the upload. Note that the coauthor is specified by an email address that should correspond to the email linked to the person's NOMAD account. See more about searching for users <a href="https://fairmat-nfdi.github.io/nomad-utility-workflows/how_to/use_api_functions.html#nomad-user-metadata">nomad-utility-workflows DOCS &gt; NOMAD User Metadata</a>.</p>
<p>The metadata should be stored as a dictionary as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="s2">&quot;upload_name&quot;</span><span class="p">:</span> <span class="s1">&#39;&lt;new_upload_name&gt;&#39;</span><span class="p">,</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;https://doi.org/xx.xxxx/xxxxxx&quot;</span><span class="p">],</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="s2">&quot;datasets&quot;</span><span class="p">:</span> <span class="s1">&#39;&lt;dataset_id&gt;&#39;</span><span class="p">,</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="s2">&quot;embargo_length&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="s2">&quot;coauthors&quot;</span><span class="p">:</span> <span class="p">,</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s1">&#39;This is a test upload...&#39;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>    <span class="p">},</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="p">}</span>
</code></pre></div>
<p>Let's simply add a name to each upload and then link them to the dataset that we created:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># dft_upload_ids - should be previously defined in your notebook</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1"># dataset_id - should be previously defined in your notebook</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c1"># define the timing parameters</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">max_wait_time</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># 30 seconds</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 seconds</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="k">for</span> <span class="n">i_upload</span><span class="p">,</span> <span class="n">upload</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dft_upload_ids</span><span class="p">):</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>    <span class="n">metadata_new</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;upload_name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Test Upload - DFT-</span><span class="si">{</span><span class="n">i_upload</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;datasets&#39;</span><span class="p">:</span> <span class="n">dataset_id</span><span class="p">}</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>    <span class="n">edit_upload_metadata</span><span class="p">(</span><span class="n">upload</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">upload_metadata</span><span class="o">=</span><span class="n">metadata_new</span><span class="p">)</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>    <span class="c1"># wait until the upload is processed successfully before continuing</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="k">while</span> <span class="n">elapsed_time</span> <span class="o">&lt;</span> <span class="n">max_wait_time</span><span class="p">:</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>        <span class="n">nomad_upload</span> <span class="o">=</span> <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">upload</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>        <span class="c1"># Check if the edit upload is complete</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>        <span class="k">if</span> <span class="n">nomad_upload</span><span class="o">.</span><span class="n">process_status</span> <span class="o">==</span> <span class="s1">&#39;SUCCESS&#39;</span><span class="p">:</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>            <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nomad_upload</span><span class="p">)</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>            <span class="k">break</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>        <span class="c1"># Wait the specified interval before the next call</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>        <span class="n">elapsed_time</span> <span class="o">+=</span> <span class="n">interval</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Maximum wait time of </span><span class="si">{</span><span class="n">max_wait_time</span><span class="o">/</span><span class="mf">60.</span><span class="si">}</span><span class="s1"> minutes exceeded. Edit Upload with id </span><span class="si">{</span><span class="n">upload</span><span class="si">}</span><span class="s1"> is not complete.&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Let's also add the drag and drop upload with the MD data to our dataset. First, go to <a href="https://nomad-lab.eu/prod/v1/test/gui/user/uploads">Test Deployment &gt; PUBLISH &gt; Uploads</a> and find the <code>upload_id</code> for the MD data.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&lt;path to PIDs&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;PIDs.json&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>    <span class="n">pids_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">md_upload_id</span> <span class="o">=</span> <span class="n">pids_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upload_ids&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;md&#39;</span><span class="p">)</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">metadata_new</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;upload_name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Test Upload - MD-equilibration&#39;</span><span class="p">,</span> <span class="s1">&#39;datasets&#39;</span><span class="p">:</span> <span class="n">dataset_id</span><span class="p">}</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">edit_upload_metadata</span><span class="p">(</span><span class="n">md_upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">upload_metadata</span><span class="o">=</span><span class="n">metadata_new</span><span class="p">)</span>
</code></pre></div>
<p>Before moving on, let's check that this additional process is complete:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">nomad_upload</span> <span class="o">=</span> <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">md_upload_id</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">nomad_upload</span><span class="o">.</span><span class="n">process_status</span> <span class="o">==</span> <span class="s1">&#39;SUCCESS&#39;</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">nomad_upload</span><span class="o">.</span><span class="n">process_running</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kc">True</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kc">True</span>
</code></pre></div>
</details>
<p>Now, go to your uploads page in NOMAD to verify that your uploads are now named. Go to <code>PUBLISH &gt; Datasets</code>. You should see the dataset that you created for this tutorial. Click the arrow to the right of this dataset to view all the entries that have been added to your dataset so far:</p>
<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="../assets/dataset.png" alt="" width="100%" title="Click to zoom in">
    </label>
</div>

<h2 id="publishing-uploads">Publishing Uploads<a class="headerlink" href="#publishing-uploads" title="Permanent link">&para;</a></h2>
<p>Before publishing uploads, it is advisable to browse the individual entries to make sure there are no obvious problems, e.g., in the visualizations in the <code>Overview</code> tab or in the <code>LOG</code> tab (there is a clear <span style="color:red">red</span> <code>!</code> to indicate if there were errors in processing). Note that it is possible that the processing reports as successful while still having some errors. If you have too many uploads to inspect manually, choosing a representative subset is advisable. If you find any problems, you can receive assistance by posting on <a href="https://discordapp.com/channels/1201445470485106719/1275764272122826752" target="_blank">#software-updates</a> on the NOMAD Discord Server&mdash;If you are not yet a member of the NOMAD server use <a href="https://discord.gg/Gyzx3ukUw8" target="_blank">Invitation to Discord</a>.</p>
<p>We can publish all 4 uploads that we made so far with <code>publish_upload()</code>, making it publicly available on the Test NOMAD deployment (again these will be eventually deleted).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once the upload is published you will no longer be able to make changes to the raw files that you uploaded. However, the upload metadata (accessed and edited in the above example) can be changed after publishing.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">all_upload_ids</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">dft_upload_ids</span><span class="p">,</span> <span class="n">md_upload_id</span><span class="p">]</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">responses</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1"># define the timing parameters</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="n">max_wait_time</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># 30 seconds</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="n">interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 seconds</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="k">for</span> <span class="n">upload</span> <span class="ow">in</span> <span class="n">all_upload_ids</span><span class="p">:</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>    <span class="n">published_upload</span> <span class="o">=</span> <span class="n">publish_upload</span><span class="p">(</span><span class="n">upload</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>    <span class="c1"># wait until the upload is processed successfully before continuing</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>    <span class="n">elapsed_time</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>    <span class="k">while</span> <span class="n">elapsed_time</span> <span class="o">&lt;</span> <span class="n">max_wait_time</span><span class="p">:</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>        <span class="n">nomad_upload</span> <span class="o">=</span> <span class="n">get_upload_by_id</span><span class="p">(</span><span class="n">upload</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>        <span class="c1"># Check if the edit upload is complete</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>        <span class="k">if</span> <span class="n">nomad_upload</span><span class="o">.</span><span class="n">process_status</span> <span class="o">==</span> <span class="s1">&#39;SUCCESS&#39;</span><span class="p">:</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>            <span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nomad_upload</span><span class="p">)</span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>            <span class="k">break</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>        <span class="c1"># Wait the specified interval before the next call</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>        <span class="n">elapsed_time</span> <span class="o">+=</span> <span class="n">interval</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>        <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Maximum wait time of </span><span class="si">{</span><span class="n">max_wait_time</span><span class="o">/</span><span class="mf">60.</span><span class="si">}</span><span class="s1"> minutes exceeded. Publish Upload with id </span><span class="si">{</span><span class="n">upload</span><span class="si">}</span><span class="s1"> is not complete.&#39;</span><span class="p">)</span>
</code></pre></div>
<h2 id="more-resources">More Resources<a class="headerlink" href="#more-resources" title="Permanent link">&para;</a></h2>
<p>More detailed documentation can be found <a href="https://fairmat-nfdi.github.io/nomad-utility-workflows/how_to/use_api_functions.html">nomad-utility-workflows DOCS &gt; Perform API Calls</a>.
An exhaustive list of API endpoints and commands are explained in the <a href="https://nomad-lab.eu/prod/v1/test/api/v1/extensions/docs">NOMAD API Dashboard</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../core/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part 1 - Core Functionalities">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Part 1 - Core Functionalities
              </div>
            </div>
          </a>
        
        
          
          <a href="../custom/" class="md-footer__link md-footer__link--next" aria-label="Next: Part 3 - Custom Entries">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Part 3 - Custom Entries
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.footer", "content.code.copy", "versioning", "content.buttons"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
      
        <script src="https://unpkg.com/cytoscape@3.19.1/dist/cytoscape.min.js"></script>
      
        <script src="../assets/custom.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>